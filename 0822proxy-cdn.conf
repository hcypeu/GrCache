upstream c99a552655ba02a37e58a94cc67b1706 {
	server 45.248.68.84:80 weight=10 max_fails=3 fail_timeout=45s max_conns=5000;
	server 45.248.68.250:80 weight=10 max_fails=3 fail_timeout=45s max_conns=5000;
	keepalive 32;
}
server {
    listen 80;
    listen 443 ssl http2;
    ssl_certificate ssl/huayu06.cn.crt;
    ssl_certificate_key ssl/huayu06.cn.key;
    ssl_protocols TLSv1 TLSv1.1 TLSv1.2 TLSv1.3;
    ssl_ciphers TLS13-AES-256-GCM-SHA384:TLS13-CHACHA20-POLY1305-SHA256:TLS13-AES-128-GCM-SHA256:TLS13-AES-128-CCM-8-SHA256:TLS13-AES-128-CCM-SHA256:EECDH+CHACHA20:EECDH+AES128:RSA+AES128:EECDH+AES256:RSA+AES256:EECDH+3DES:RSA+3DES:!MD5;
    ssl_prefer_server_ciphers on;
    ssl_session_timeout 10m;
    ssl_session_cache shared:SSL:10m;
    ssl_buffer_size 1400;
    add_header Strict-Transport-Security max-age=15768000;
    ssl_stapling on;
    ssl_stapling_verify on;
    server_name www.huayu06.cn huayu06.cn;
    add_header Via $hostname;
    access_log /data/wwwlogs/www.huayu06.cn_nginx.log combined;
    error_log /data/wwwlogs/error_nginx.log;
    if ($ssl_protocol = "") { return 301 https://$host$request_uri; }
    if ($host != www.huayu06.cn) {  return 301 $scheme://www.huayu06.cn$request_uri;  }
    add_header GR-Cache-Status $upstream_cache_status;
	
	proxy_set_header Host $server_name;
	proxy_set_header X-Real-IP $remote_addr;
	proxy_set_header REMOTE-HOST $remote_addr;
	proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
	proxy_http_version 1.1;
	proxy_set_header Connection '';
	proxy_cache cache_one;
	proxy_cache_key '"$host$request_uri$cookie_user"';
	proxy_ignore_headers X-Accel-Limit-Rate;
	location / {
		proxy_pass http://c99a552655ba02a37e58a94cc67b1706;
		proxy_cache_valid 200 304 60s;
	}
	location ~ \.(js|css|tpl|txt|xml)$ {
		proxy_pass http://c99a552655ba02a37e58a94cc67b1706;
		gzip on;
		proxy_cache_valid 200 304 1d;
	}
	location ~ \.(jpeg|jpg|png|svg|gif|m3u8|ts)$ {
		proxy_pass http://c99a552655ba02a37e58a94cc67b1706;
		proxy_cache_valid 200 304 7d;
		expires 7d;
	}
	location ~ \.(woff|woff2|eot|font|fon|ttf|otf|ttc)$ {
		proxy_pass http://c99a552655ba02a37e58a94cc67b1706;
		proxy_cache_valid 200 304 15d;
		expires 15d;
	}
}
